#### Different API collection toolkit and go toos
###### API allows two applications to interact with each other without any user intervention 
:fire: APIs simplify design and development of new applications and services, and integration and management of existing ones ([Improved collaboration]) #API 

**API** structure how data is exchanged between DB and any software accessing it

**Choosing the Right Type of API(4)**
- Open APIs, which any developer can access.
- Partner APIs, which only authorized developers may access.
- Internal APIs, which only internal teams may access.
- Composite APIs, which combine multiple APIs.

### HTTP
- The API we are using uses the HTTPS protocol.
- HTTPS ensures that the connection is encrypted.
- All APIs should use HTTP/S.
- The HTTP request message will contain: 
      * URL (address)
      * Request method (GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS)
      * Headers (User-Agent: Postman)
      * Body
- The HTTP response message will contain: 
      *Status code
            - 100 : informational
            - 200 : success 
            - 300 : redirect
            - 404 : client error 
            - 500 : server error
      *Headers
            - Content-Type
            - uccess User-Agent
            - Cache-Control
      *Body
            - form data >>> client_id : {{client-id}}
            - raw json data  
            
### Collections and variables
- You can save requests so that you can re-use them later on.
- All requests need to be added to a Postman collection.
- Typically you will have a Postman collection for each API.
- We are storing the base address of the API in a collection variable called `baseUrl`. 
- Our saved baseUrl will be displayed as `{{baseUrl}}` in the address bar.
- Variables allow us to avoid repeating the same information and easily make changes.
- A Postman variable has two states
   * INITIAL VALUE - This will be available to others if you share the collection.
   * CURRENT VALUE - This is private to you and this is the value that Postman uses.


### Query parameters
- Query parameters start after the `?` in the URL.
   * example : `{{baseUrl}}/books?type=fiction`
- The format is `key=value`
- Multiple query parameters are delimited in the URL with an `&`. 
   * example: `foo=1&bar=2`
- Depending on the API, some query parameters can be optional or mandatory.
- A response status 400 indicates an issue with the request data.
- You can enable and disable parameters by clicking the checkbox associated with each key-value pair.

```json
Assignment
- Study the API documentation and use the `limit` query parameter in the `/books` endpoint.
- Try out different values.
- Can you make the API return a status code 400?
```

## Path variables
- `:bookId` is a path variable in the URL.
- This endpoint allows us to specify a value that changes all the time, depending on the book.
- `:bookId` is just a placeholder and does not get sent.
- You can use path variables in combination with query parameters (if the API accepts this).

### NB
```
**path parameters are used to identify a specific resource or resources**.
Use path variables when you need to identify a specific resource within the API 
You can't omit values in path parameters since they are part of the URL
					AND
**query parameters are used to sort/filter resources.** 
Use query parameters when you need to provide additional information or filter criteria without changing the core resource being accessed
```

### POST request / API Authentication
- A `POST` request allows you to send data in the request body.
- The endpoint for submitting orders requires authentication.
- Some APIs/endpoints are public/private and require/not authentication.
- An access token is temporary password generated by the API.
- To send JSON, select the POST request method and from the Body select `Raw` and from the list `JSON`.

### JSON format
- You need to specify valid JSON, otherwise the server won't understand your request.
- Use double-quotes `""` for strings, separate key-value pairs with a comma sign `,`
- Numbers, booleans don't need to be between quotes.
- Postman will indicate when your JSON is invalid.
```json
Assignment
- Create the POST request to order a book.
- Try ordering a book that is not in stock.
```

###  Random test data
- You can use a special type of Postman variable to generate random data
 Example:
```json
{
  "bookId": 1,
  "customerName": "{{$randomFullName}}"
}
```
- To inspect the request body you can use the Postman console scroll to `request body`
```json
{
  "bookId": 1,
  "customerName": "Leticia King" 
}
```
### Viewing existing orders
- Using the GET request method on the `orders` endpoint will give us a list of orders.
- Using the POST request method on the same endpoint will let us create a new order
```json
Assignment
- Look at the API documentation and identify the endpoint that would allow you to see a single order.
```

### PATCH request
- A `PATCH` request is typically used for updating existing data.
- A `PATCH` usually does a partial update, by changing only some of the properties.

### DELETE request
- A `DELETE` request is used for deleting data.
- If you try to get the same data with a `GET` request, you will get a `404 Not Found` status code.

### Unit 2
#### Test automation with Postman
API testing is the process of confirming that an API is working as expected. 

Developers can run API tests manually, or they can automate them with an API testing tool.

```json
console.log(responseData);
console.log(responseData.status);
console.log(responseData['status']);
```
### Introduction to test automation
- In this second part of the course, our goal is to automate testing of the API.
- So far, we have done manual testing but we want to write API tests to avoid having to manually re-test the API

### Your first API tests
- We are looking at the response to understand if the API is working properly.
- With API tests we want to avoid manually re-testing the API.
- Tests in Postman are written in JavaScript.
- Tests are executed ONLY after the response has arrived from the API.
- Postman uses an assertion library called Chai.js
- Testing the response status code is one of the easiest tests you can write.
- When writing tests, we want to make sure the tests fail.
- To make the assertions on a JSON response, you first need to parse it.
- To see the contents of a JavaScript variable you can use `console.log()`
- To get a property of an object, you can use this syntax: `someobject.someproperty`
   * alternative syntax: `someobject["someproperty"]`

### Assignment
- Add tests for all the requests in the collection that verify the status code.

### Postman variables
- Postman variables are fundamental to automating testing of the API.
- Postman environments (environment variables) are good if you have multiple testing environments (localhost, testing, production)
- Postman collection variables are saved in the collection.
- Postman global variables are available to all collection in a workspace.
- We use Postman global variables as the data we save is not that important after the execution has stopped.


### Extracting data from the response
- Having hardcoded values in requests can make the API tests fail if the data changes.
- We are using the filter function available on all arrays to remove the books that are not available.
- Always use `console.log()` to view the data you are trying to set as a variable.
```json
Assignment
- Test that the book extracted from the response is of type `non-fiction`
- Ensure that the test fails.
```

### Assignment
- Use the Postman global variable `bookId` in the requests "Get single book" and "Order book".
- Write a test that verifies the stock is >0
   * use this assertion as a starting point: `pm.expect(1).to.be.above(2)`

### Collection runner
- The Collection runner is a built-in functionality of Postman.
- The Collection runner allows you to execute the entire collection with just one click.
- Make sure to check (:white_check_mark:) the "Save response" box as this will allow you to inspect the response body.

### Request execution order
- If you run a Postman collection, the default order is as you have it in the collection.
- You can change that order if you use `postman.setNextRequest` and specify the name of the next request
- If you wish to stop the execution prematurely, you can so so by running `postman.setNextRequest(null)`

### Postman monitors
- Creating a Postman monitor ensures that you can run a Postman collection according to a pre-defined schedule.
- Running the collection will be handled by Postman on their infrastructure, you don't need to keep Postman open.
- If you are not familiar with continuous integration servers like Jenkins, GitLab CI or TeamCity, this is a quick and easy way to access a Postman collection.
- The API needs to be accessible from any network.

### Newman
- Newman is a CLI tool that can take a Postman collection, run all the tests and generate a report at the end.
- Newman does not have an interface, you need to work with it from the terminal.
- Often Newman is installed on an integration server like Jenkins, GitLab CI or TeamCity.
- To run Newman on your computer, you need to have Node.js installed.
   * you can download Node.js from https://nodejs.org/ (download the LTS version)
- To install newman, run the command: `npm install -g newman`
- Check if newman is install with: `newman --version`
- There are three ways to access a collection from Newman:
         * Export the collection as a JSON file.
         * Share with a public link.
         * Use the Postman API to get the collection.

### HTML reports with Newman
- html extra is the most popular reporter in the Postman community

### CI/CD overview
- Newman is particularly useful when you integrate it with a CI server.

 



[TutorialsPoint](https://www.tutorialspoint.com/restful/restful_quick_guide.htm)

[IBM API Notes](https://www.ibm.com/topics/api)

More Bliss: [MaG!C API](https://dev.to/ainasanghi/unraveling-the-magic-of-apis-a-beginners-guide-to-integration-superpowers-c39)

[FreeCodeCamp](https://www.youtube.com/watch?v=VywxIQ2ZXw4)
